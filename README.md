### Quick start
**The purpose of this file is to serve as documentation for the PBI Asset Liability Model (ALM)**

**Make sure you have access to Microsoft Power BI**

**Make sure you have access to Microsoft Excel**

**Make sure you have access to Microsoft SQL Server**

**We are currently using a test server hosted here: VANDESKTOP70\PBI_EXPRESS **

**The ALM will only be available if connected to the PBI network**

Software requirements and summary:
As V1.0 of the PBI ALM model we have decided to use the following technologies:

1. Microsoft SQL Server (Data storage & Calculation Engine)

This decision was made in support of the large datasets that get generated when doing Monte-Carlo Simulations. Using a database technology allows for efficient linking of datasets and storing of information in a central environment. SQL as a programming language is also powerful for automating calculations. Microsoft SQL Server is also the underlying technology of the PBI Pension Admin system and we should be able to leverage of licensing agreements that are already in place going into a production environment.

2. Microsoft Excel (User Interface)

We needed a tool to communicate with the underlying SQL Server database - MS Excel can do this if set up correctly and serves as a free tool to build the interface between the consultant and the calculation engine. In the longer term this functionality can be replaced by an HTML based front-end.

To ensure that Excel can communicate with SQL some drivers may be required, some computers come with these out-of-the-box. Other need them installed. They are freely available from the Microsoft website.

The SQL drivers for VBA can be found here:
 
For 32 bit machines please install
 
http://go.microsoft.com/fwlink/?LinkID=239647&clcid=0x409
 
For 64 bit
 
http://go.microsoft.com/fwlink/?LinkID=239648&clcid=0x409
 
Installing this also wouldn’t hurt
 
https://www.microsoft.com/en-us/download/details.aspx?id=5793

3. Microsoft Power BI (Data presentation)

Microsoft Power BI is a reasonably new software where Microsoft have decided to embrace the "open source" way of thinking. This tool is free for use (the desktop version) and provides amazing capability to aggregate and visualize large datasets. It also has a vibrant online collaborative community which ensures that the tool gets better and better over time.

Power BI can freely be downloaded from the Microsoft website at the following address: 

https://powerbi.microsoft.com/en-us/downloads/

We will also keep a version of the software on the network for easy updates/installation. Power BI is currently being updated by Microsoft on a monthly basis.

# Table of Contents
* [Database Structure](#database-structure)
* [Naming Conventions](#naming-conventions)
* [Getting Started](#getting-started)
    * [Dependencies](#dependencies)
    * [Environments](#environments)
    * [Running the ALM](#running-the-alm)
* [Configuration](#configuration)
* [Frequently asked questions](#frequently-asked-questions)
* [Don'ts](#donts)
* [Deployment](#deployment)


## Database Structure
The PBI ALM is built upon a SQL database that stores the logic for creating projections for asset class returns, this includes the ability to generate assumptions, calculate asset and liability projections and store these results for future reference. Here's how it looks:
```
PBI_ALM/			   * All tables and procedures used as part of the ALM is stored in the tables section, the naming convention is used to distinguish different sections of the ALM. The naming convention is described in more detail later in this document.
 ├──Random Numbers (Fixed Interest)/                         
 |   ├──FI_R_Infl     		   * Random number table used for projecting future Inflation
 |   ├──FI_R_RealReturn            * Random number table used for projecting future Real Return
 |   ├──FI_R_TermPremium           * Random number table used for projecting future Term Premium
 |   ├──FI_R_CredPrem              * Random number table used for projecting future Credit Premium
 │   └──FI_R_StressReg             * Random number table used for assessing whether the economy will be stressed in a future period
 │
 ├──Random Numbers (Non-fixed Interest)/
 |   ├──NFI_R_NCorr                * Random number table used for projecting future returns on non-fixed income investments (currently 8 assset classes), this table is not correlated in any way with each other or any of the previously mentioned random numbers
 |   ├──NFI_R_Corr     		   * Correlated random number table used for projecting future returns on non-fixed income investments, this is generated by doing a Colesky decomposition on a matrix of random numbers (currently done using VBA code)
 |   └──NFI_R_Corr_Final           * Correlated random number table that has been normalised to be from a uniform distribution with values of 1 and 0 removed
 |
 ├──Input Tables/                  * these tables are used as input for projecting asset class returns for a given assumption set
 │   ├──Fixed Interest/            * these tables support the projection of the fixed interest asset classes
 │   │   ├──FI_I_Infl/ 		   * Projected Inflation generated by (GenerateProjectedInflation)
 │   │   ├──FI_I_RealReturn/ 	   * Projected Real Return generated by (GenerateProjectedRealReturn)
 │   │   ├──FI_I_ShortTermReturn/  * Projected Short Term Return generated by (GenerateProjectedShortTermReturn)
 │   │   ├──FI_I_TermPremium/ 	   * Projected Term Premium generated by (GenerateProjectedTermPremium)
 │   │   └──FI_I_LongTermReturn/   * Projected Long Term Return generated by (GenerateProjectedLongTermReturn)
 │   │
 │   └──Non-fixed Interest/            * these tables support the projection of the non-fixed interest asset classes, they are often (if not always) combined with the input tables above
 │       └──NFI_I_TriangleDistribution * Projected Triangle distribution to fatten up the tail of the returns distribution per asset class generated by (GenerateNFITriangleDistribution)
 │
 ├──Asset Class Returns/            * these tables store the projected returns for each asset class
 │   ├──Fixed Interest/             * these tables store the projected returns for all fixed income asset classes generated by (GenerateProjectedFIReturn)
 │   │   ├──FI_AC_UBond/ 	    * Universal Bonds
 │   │   ├──FI_AC_LTBond/ 	    * Long-Term Bonds
 │   │   ├──FI_AC_Mort/ 	    * Mortgages
 │   │   ├──FI_AC_Corp/ 	    * Corporate Debt 
 │   │   ├──FI_AC_PrDebt/ 	    * Private Debt
 │   │   ├──FI_AC_STCr/ 	    * Short-term credit
 │   │   └──FI_AC_BorrowCst/        * Borrowing Cost
 │   │
 │   └──Non-fixed Interest/         * these tables store the projected returns for all non-fixed income asset classes generated by (GenerateProjectedNFIReturn)
 │          ├──NFI_AC_CdnEq         * Canadian Equity 
 │          ├──NFI_AC_GloEq         * Global Equity
 │          ├──NFI_AC_EMEq          * Emerging Market Equity
 │          ├──NFI_AC_CdnLVEq       * Canadian Low Volatility Equity
 │          ├──NFI_AC_GloLVEq       * Global Low Volatility Equity
 │          ├──NFI_AC_IE            * Infrastructure Equity
 │          ├──NFI_AC_RE            * Real Estate
 │          └──NFI_AC_PE            * Private Equity
 │
 ├──AlternativeMixes                * Table for storing the projected returns for each asset mix that will be used in the ALM generated by (GenerateProjectedPortfolioReturn)
 |
 ├──Asset Liability Model/          * these tables store the projected results of the asset liability model
 │   ├──Additional Assumptions/     * these tables store the additional assumptions required that are derived from the asset mix
 │   │   ├──ALM_I_L_DiscountRate/   * the Discount Rate to be used in the projected generated by (GenerateProjectedDiscountRate)
 │   │   ├──ALM_I_Salary_Increase/  * the Salary Increases Expected
 │   │   ├──ALM_I_COLA/ 	         * the Cost of Living Adjustments Expected (COLA)
 │   │   └──ALM_I_NC_FS_Change/     * the Future change in Normal/Service Costs
 │   │
 │   ├──Additional Inputs/          * Additional inputs required from either external party or external process
 │   |   └──ALM_I_L_CashFlow/       * Table storing the expected liability cash flows as result of a valuation process
 |   │   
 |   ├──Liability Projections/      	* these tables store the results of the liability projections
 │   │   ├──ALM_R_L_ProjectedLiability/ * the projected value of the liability generated by (######)
 │   │   └──LIABILITY TABLE 2/      	* Borrowing Cost
 │   |
 │   └──Asset Projections/          * these tables store the results of the asset projections
 │          ├──ALM_R_A_ProjectedBenefitPayments  * the projected value of future benefit payments
 │          ├──ALM_R_A_ProjectedContributions    * the projected value of future contributions
 │          ├──ALM_R_A_ProjectedCashflow         * the projected value of future cash flow
 │          ├──ALM_R_A_ProjectedMVA              * the projected Market Value of Assets (MVA)
 │          ├──ASSET TABLE 5        * 
 │          ├──ASSET TABLE 6        * 
 │          └──ASSET TABLE 7        * 
 │
 ├──AssumptionSet                   * Table for storing the assumption set definition
 ├──ResultSet                       * Table for storing the result set definition
 ├──ParameterHistory                * Table for storing the historical parameter values associated with each model run
 └──dmRefCodes, Tally               * Help tables to enable rolling out of results over a number of iterations
```

# Naming Conventions
The following section contain explanations of all acronymns used within the ALM database. Reading this in conjunction with the database structure should give you a broad understanding of what information is contained where and how the model ties together.

   *FI - Fixed Income   
   *FI_AC - Fixed Income Asset Class   
   *FI_I - Fixed Income Input Numbers   
   *FI_R - Fixed Income Random Numbers   
   *NFI - Non-Fixed Income   
   *NFI_AC - Non-Fixed Income Asset Class   
   *NFI_I - Non-Fixed Income Input Numbers   
   *NFI_R - Non-Fixed Income Random Numbers   
   *ALM - Asset Liability Model   
   *ALM_I - ALM Input   
   *ALM_R - ALM Results
   


# Getting Started
## Dependencies

## Environments

## Running the ALM
The ALM is currently run from a Excel based front-end. The front-end uses VBA code to communicate with the SQL Server Database that the ALM model is hosted on. In order to run the ALM the user will need to set up his assumptions using the front-end following these steps.

### 1. Define Assumption Set

The first step in running the ALM is to set up the "Assumption Set". This term is used to describe the model inputs and assumptions that will be used to project the assets and liabilities into the future. Setting up the "Assumption Set" is a large part of the process and it is up to the user to decide whether a "Assumption Set" is required for the scenario to be modelled. 
 
#### 1.1. Load Assumption Set into Database

Details on each "Assumption Set" is stored in the database in the dbo.AssumptionSet table, it contains the following fields that need to be populated before physically creating the required assumptions

		*AssumptionSetKey* - assigned by the database as unique identifier  
		*AssumptionSetNo* - assigned by the user   
		*AssumptionSetDescript* - assigned by the user   
		*CreatedDate* - assigned by the database   
		*CreatedBy* - assigned by the database, linked to the user login used   


#### 1.2. Generate Required Random Numbers (if applicable)
##### 1.2.1. Global Economical Indicators  

Each of the following is a table of uniform random variables from 0 to 1.
	   
1.2.1.1. Inflation      
1.2.1.2. Real Return      
1.2.1.3. Term Premium      
1.2.1.4. Credit Premium      
1.2.1.5. Stress Regime      
		  
##### 1.2.2. Non-fixed Income Asset Class Random numbers   
	   
**1.2.2.1. Uncorrelated random numbers per asset class**\
For each of the eight non-fixed income asset classes:

* Canadian Equity (CdnEq)
* Global Equity (GloEq)
* Emerging Market Equity (EMEq) 
* Canadian Low-Volatility Equity (CdnLVEq)  
* Global Low-Volatility Equity (GloLVEq) 
* Private Equity (PE)  
* Infrastructure Equity (IE)
* Real Estate (RE)     

 A table of 2000 simulations by 30 years is generated with each entry equal to the following:\
\
<a href="https://www.codecogs.com/eqnedit.php?latex=Random_{Non-Fixed&space;Income&space;Asset&space;Class}&space;\sim&space;Uniform(0,1)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?Random_{Non-Fixed&space;Income&space;Asset&space;Class}&space;\sim&space;Uniform(0,1)" title="Random_{Non-Fixed Income Asset Class} \sim Uniform(0,1)" /></a>\
\
**1.2.2.2. Cholesky Decomposition** \
An algorithm is applied to the specified correlation matrix of the eight non-fixed income asset classes. The result is an upper triangle matrix, used to correlate each of the eight uncorrelated random numbers matrices.

**Insert example**
\
\
**1.2.2.3. Correlated random numbers with messed distribution**\
Multiply the triangular matrix generated from the Cholseky Decomposition by each of the uncorrelated random numbers matrices. This produces the desired eight random but correlated matrices.  \
\
**1.2.2.4. Check that the distribution remains uniform between 0 and 1**\
1.2.2.4.1. Ranking and reshuffle\
1.2.2.4.2. Correct for 0's and 1's

Scale the matrices since they no longer range from 0 to 1 due to the above matrix multiplication. Thus each of the eight asset classes are as follows:\
\
<a href="https://www.codecogs.com/eqnedit.php?latex=RandomNonFixedIncome_t&space;=&space;\text{Randomly&space;Correlated&space;Numbers&space;from}\quad&space;[0,1]" target="_blank"><img src="https://latex.codecogs.com/gif.latex?RandomNonFixedIncome_t&space;=&space;\text{Randomly&space;Correlated&space;Numbers&space;from}\quad&space;[0,1]" title="RandomNonFixedIncome_t = \text{Randomly Correlated Numbers from}\quad [0,1]" /></a>


##### 1.2.3. Generate Stress Regime Triangle Distributions
<a href="https://www.codecogs.com/eqnedit.php?latex=ReturnUnderStressedRegime_t=&space;\begin{cases}&space;\sqrt{RandomNonFixedIncome_t*LimitA}&plus;{{\color{Red}Min}}&space;&\quad\text{for}\quad&space;RandomNonFixedIncome_t&space;<&space;\frac{{\color{Red}BreakPoint-&space;Min}}{{\color{Red}Max-&space;Min}},\\&space;{{\color{Red}Max}}&space;-&space;\sqrt{[1-RandomNonFixedIncome_t]*LimitB}&\quad\text{for}\quad&space;RandomNonFixedIncome_t&space;>&space;\frac{{\color{Red}BreakPoint-&space;Min}}{{\color{Red}Max-&space;Min}},\\&space;\end{cases}&space;\\&space;\\&space;\\&space;\begin{array}{rcl}&space;$where$\quad&space;LimitA&space;=&space;({\color{Red}Max-&space;Min})*({\color{Red}BreakPoint-&space;Min})&space;\\&space;$and$&space;\quad&space;LimitB&space;=&space;({\color{Red}Max-&space;Min})*({\color{Red}Max&space;-&space;BreakPoint})&space;\end{array}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?ReturnUnderStressedRegime_t=&space;\begin{cases}&space;\sqrt{RandomNonFixedIncome_t*LimitA}&plus;{{\color{Red}Min}}&space;&\quad\text{for}\quad&space;RandomNonFixedIncome_t&space;<&space;\frac{{\color{Red}BreakPoint-&space;Min}}{{\color{Red}Max-&space;Min}},\\&space;{{\color{Red}Max}}&space;-&space;\sqrt{[1-RandomNonFixedIncome_t]*LimitB}&\quad\text{for}\quad&space;RandomNonFixedIncome_t&space;>&space;\frac{{\color{Red}BreakPoint-&space;Min}}{{\color{Red}Max-&space;Min}},\\&space;\end{cases}&space;\\&space;\\&space;\\&space;\begin{array}{rcl}&space;$where$\quad&space;LimitA&space;=&space;({\color{Red}Max-&space;Min})*({\color{Red}BreakPoint-&space;Min})&space;\\&space;$and$&space;\quad&space;LimitB&space;=&space;({\color{Red}Max-&space;Min})*({\color{Red}Max&space;-&space;BreakPoint})&space;\end{array}" title="ReturnUnderStressedRegime_t= \begin{cases} \sqrt{RandomNonFixedIncome_t*LimitA}+{{\color{Red}Min}} &\quad\text{for}\quad RandomNonFixedIncome_t < \frac{{\color{Red}BreakPoint- Min}}{{\color{Red}Max- Min}},\\ {{\color{Red}Max}} - \sqrt{[1-RandomNonFixedIncome_t]*LimitB}&\quad\text{for}\quad RandomNonFixedIncome_t > \frac{{\color{Red}BreakPoint- Min}}{{\color{Red}Max- Min}},\\ \end{cases} \\ \\ \\ \begin{array}{rcl} $where$\quad LimitA = ({\color{Red}Max- Min})*({\color{Red}BreakPoint- Min}) \\ $and$ \quad LimitB = ({\color{Red}Max- Min})*({\color{Red}Max - BreakPoint}) \end{array}" /></a>

<a href="https://www.codecogs.com/eqnedit.php?latex=\text{Compared&space;to&space;the&space;excel&space;spreadsheeet,&space;I&space;have&space;simplified}\quad&space;\frac{(BreakPoint-min)^2}{LimitA}&space;\quad&space;\text{to}&space;\quad&space;\frac{(BreakPoint-min)}{(Max-min)},&space;\quad&space;\\&space;\\&space;\text{since}&space;\quad&space;LimitA=(Max-Min)*(BreakPoint-min),&space;\text{I&space;did&space;this&space;because&space;it's&space;easier&space;to&space;interpret.}\\&space;\text{as&space;I&space;view&space;it&space;as&space;the&space;percent&space;location&space;of&space;the&space;BreakPoint&space;relative&space;to&space;the&space;difference&space;between&space;the&space;max&space;and&space;min.}\\&space;\text{for&space;example,&space;if&space;max=5,&space;min=3,&space;Breakpoint=4&space;then}{\frac{(BreakPoint-min)}{(Max-min)}=0.50},&space;\\&space;\text{which&space;I&space;interpret&space;as,&space;the&space;breakpoint&space;is&space;0.5&space;between&space;the&space;max&space;and&space;min}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\text{Compared&space;to&space;the&space;excel&space;spreadsheeet,&space;I&space;have&space;simplified}\quad&space;\frac{(BreakPoint-min)^2}{LimitA}&space;\quad&space;\text{to}&space;\quad&space;\frac{(BreakPoint-min)}{(Max-min)},&space;\quad&space;\\&space;\\&space;\text{since}&space;\quad&space;LimitA=(Max-Min)*(BreakPoint-min),&space;\text{I&space;did&space;this&space;because&space;it's&space;easier&space;to&space;interpret.}\\&space;\text{as&space;I&space;view&space;it&space;as&space;the&space;percent&space;location&space;of&space;the&space;BreakPoint&space;relative&space;to&space;the&space;difference&space;between&space;the&space;max&space;and&space;min.}\\&space;\text{for&space;example,&space;if&space;max=5,&space;min=3,&space;Breakpoint=4&space;then}{\frac{(BreakPoint-min)}{(Max-min)}=0.50},&space;\\&space;\text{which&space;I&space;interpret&space;as,&space;the&space;breakpoint&space;is&space;0.5&space;between&space;the&space;max&space;and&space;min}" title="\text{Compared to the excel spreadsheeet, I have simplified}\quad \frac{(BreakPoint-min)^2}{LimitA} \quad \text{to} \quad \frac{(BreakPoint-min)}{(Max-min)}, \quad \\ \\ \text{since} \quad LimitA=(Max-Min)*(BreakPoint-min), \text{I did this because it's easier to interpret.}\\ \text{as I view it as the percent location of the BreakPoint relative to the difference between the max and min.}\\ \text{for example, if max=5, min=3, Breakpoint=4 then}{\frac{(BreakPoint-min)}{(Max-min)}=0.50}, \\ \text{which I interpret as, the breakpoint is 0.5 between the max and min}" /></a>


**Below is the SQL code used to run this query:**

		exec GenerateNFITriangleDistribution @max, @min, @breakpoint, @ReturnType, @AssumptionSetNo
        
          Parameters 
          
          Bottom right corner of triangle = @max,
          Bottom left corner of triangle = @min,
          Top tip of triangle = @breakpoint,
          Type of non-fixed income return = @ReturnType,
          Assumption Set Number = @AssumptionSetNo
        
            
### 1.3. Generate Projected Global Economical Indicators

#### 1.3.1. Inflation
		  
Projected inflation is based on a seed value to start with calibrated to current market conditions. Sampling is done from the Inverse Normal distribution for the noise parameter and projections are based on inflation in the previous period.
		  
		  
<a href="https://www.codecogs.com/eqnedit.php?latex=Inflation_t=&space;\begin{cases}&space;{\color{Red}Inflation_{0}}&space;&\quad\text{for}\quad&space;t&space;=&space;0,\\&space;[Inflation_{(t-1)}&space;*&space;{\color{Red}Weight}]&space;&plus;&space;{\color{Red}LongTermInflation}&space;*&space;(1&space;-&space;{\color{Red}Weight})&space;&plus;&space;\epsilon&space;&\quad\text{for}\quad&space;t&space;>&space;0,\\&space;\end{cases}&space;\\&space;\\&space;where\quad&space;\epsilon&space;=&space;\Phi^{-1}(RandomInflation;0,&space;{\color{Red}\sigma})\quad&space;and&space;\quad&space;RandomInflation\sim&space;Uniform(0,1)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?Inflation_t=&space;\begin{cases}&space;{\color{Red}Inflation_{0}}&space;&\quad\text{for}\quad&space;t&space;=&space;0,\\&space;[Inflation_{(t-1)}&space;*&space;{\color{Red}Weight}]&space;&plus;&space;{\color{Red}LongTermInflation}&space;*&space;(1&space;-&space;{\color{Red}Weight})&space;&plus;&space;\epsilon&space;&\quad\text{for}\quad&space;t&space;>&space;0,\\&space;\end{cases}&space;\\&space;\\&space;where\quad&space;\epsilon&space;=&space;\Phi^{-1}(RandomInflation;0,&space;{\color{Red}\sigma})\quad&space;and&space;\quad&space;RandomInflation\sim&space;Uniform(0,1)" title="Inflation_t= \begin{cases} {\color{Red}Inflation_{0}} &\quad\text{for}\quad t = 0,\\ [Inflation_{(t-1)} * {\color{Red}Weight}] + {\color{Red}LongTermInflation} * (1 - {\color{Red}Weight}) + \epsilon &\quad\text{for}\quad t > 0,\\ \end{cases} \\ \\ where\quad \epsilon = \Phi^{-1}(RandomInflation;0, {\color{Red}\sigma})\quad and \quad RandomInflation\sim Uniform(0,1)" /></a>

**Below is the SQL code used to run this query:**

		exec GenerateProjectedInflation @Inf_tmin1, @w, @Inf_LT, @sd_e, @mu_e, @AssumptionSetNo
		  
		  Parameters
		  
		  Initial Inflation = @Inf_tmin1, 
		  Weight = @w, 
		  Long Term Inflation = @Inf_LT, 
		  Standard Deviation = @sd_e, 
		  Mean (default = 0) = @mu_e, 
		  Assumption Set Number = @AssumptionSetNo

#### 1.3.2. Real Return  
<a href="https://www.codecogs.com/eqnedit.php?latex=RealReturn_t=&space;\begin{cases}&space;{\color{Red}RealReturn_{0}}&space;&\quad\text{for}\quad&space;t&space;=&space;0,\\&space;[RealReturn_{(t-1)}&space;*&space;{\color{Red}Weight}]&space;&plus;&space;{\color{Red}LongTermRealReturn}&space;*&space;(1&space;-&space;{\color{Red}Weight})&space;&plus;&space;\epsilon&space;&\quad\text{for}\quad&space;t&space;>&space;0,\\&space;\end{cases}&space;\\&space;\\&space;where\quad&space;\epsilon&space;=&space;\Phi^{-1}(RandomRealReturn;0,&space;{\color{Red}\sigma})\quad&space;{and&space;\quad&space;RandomRealReturn\sim&space;Uniform(0,1)}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?RealReturn_t=&space;\begin{cases}&space;{\color{Red}RealReturn_{0}}&space;&\quad\text{for}\quad&space;t&space;=&space;0,\\&space;[RealReturn_{(t-1)}&space;*&space;{\color{Red}Weight}]&space;&plus;&space;{\color{Red}LongTermRealReturn}&space;*&space;(1&space;-&space;{\color{Red}Weight})&space;&plus;&space;\epsilon&space;&\quad\text{for}\quad&space;t&space;>&space;0,\\&space;\end{cases}&space;\\&space;\\&space;where\quad&space;\epsilon&space;=&space;\Phi^{-1}(RandomRealReturn;0,&space;{\color{Red}\sigma})\quad&space;{and&space;\quad&space;RandomRealReturn\sim&space;Uniform(0,1)}" title="RealReturn_t= \begin{cases} {\color{Red}RealReturn_{0}} &\quad\text{for}\quad t = 0,\\ [RealReturn_{(t-1)} * {\color{Red}Weight}] + {\color{Red}LongTermRealReturn} * (1 - {\color{Red}Weight}) + \epsilon &\quad\text{for}\quad t > 0,\\ \end{cases} \\ \\ where\quad \epsilon = \Phi^{-1}(RandomRealReturn;0, {\color{Red}\sigma})\quad {and \quad RandomRealReturn\sim Uniform(0,1)}" /></a>

**Below is the SQL code used to run this query:**

    	exec GenerateProjectedRealReturn @RR_ST_tmin1, @w, @LT_RR_ST, @sd_e, @mu_e, @AssumptionSetNo
        
          Parameters 

          Initial Real Return = @RR_ST_tmin1,
          Weight = @w,
          Long Term Real Return = @LT_RR_ST,
          Standard Deviation = @sd_e,
          Mean (default = 0) = @mu_e,
          Assumption Set Number = @AssumptionSetNo

#### 1.3.3. Term Premium      
<a href="https://www.codecogs.com/eqnedit.php?latex=TermPremium_t=&space;\begin{cases}&space;{\color{Red}TermPremium_{0}}&space;&\quad\text{for}\quad&space;t&space;=&space;0,\\&space;[TermPremium_{(t-1)}&space;*&space;{\color{Red}Weight}]&space;&plus;&space;{\color{Red}LongTermTermPremium}&space;*&space;(1&space;-&space;{\color{Red}Weight})&space;&plus;&space;\epsilon&space;&\quad\text{for}\quad&space;t&space;>&space;0,\\&space;\end{cases}&space;\\&space;\\&space;where\quad&space;\epsilon&space;=&space;\Phi^{-1}(RandomTermPremium;0,&space;{\color{Red}\sigma})\quad&space;and&space;{\quad&space;RandomTermPremium\sim&space;Uniform(0,1)}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?TermPremium_t=&space;\begin{cases}&space;{\color{Red}TermPremium_{0}}&space;&\quad\text{for}\quad&space;t&space;=&space;0,\\&space;[TermPremium_{(t-1)}&space;*&space;{\color{Red}Weight}]&space;&plus;&space;{\color{Red}LongTermTermPremium}&space;*&space;(1&space;-&space;{\color{Red}Weight})&space;&plus;&space;\epsilon&space;&\quad\text{for}\quad&space;t&space;>&space;0,\\&space;\end{cases}&space;\\&space;\\&space;where\quad&space;\epsilon&space;=&space;\Phi^{-1}(RandomTermPremium;0,&space;{\color{Red}\sigma})\quad&space;and&space;{\quad&space;RandomTermPremium\sim&space;Uniform(0,1)}" title="TermPremium_t= \begin{cases} {\color{Red}TermPremium_{0}} &\quad\text{for}\quad t = 0,\\ [TermPremium_{(t-1)} * {\color{Red}Weight}] + {\color{Red}LongTermTermPremium} * (1 - {\color{Red}Weight}) + \epsilon &\quad\text{for}\quad t > 0,\\ \end{cases} \\ \\ where\quad \epsilon = \Phi^{-1}(RandomTermPremium;0, {\color{Red}\sigma})\quad and {\quad RandomTermPremium\sim Uniform(0,1)}" /></a>

**Below is the SQL code used to run this query:**

		exec GenerateProjectedTermPremium @TP_tmin1, @w, @LT_TP, @sd_e, @mu_e, @AssumptionSetNo
        
          Parameters 

          Initial Term Premium = @TP_tmin1,
          Weight = @w,
          Long Term Term Premium = @LT_RR_ST,
          Standard Deviation = @sd_e,
          Mean (default = 0) = @mu_e,
          Assumption Set Number = @AssumptionSetNo
        
#### 1.3.4. Short Term Return
<a href="https://www.codecogs.com/eqnedit.php?latex=ShortTermReturn_t=&space;Inflation_t&space;&plus;&space;RealReturn_t&space;&\quad\text{for}\quad&space;t&space;\geq&space;0" target="_blank"><img src="https://latex.codecogs.com/gif.latex?ShortTermReturn_t=&space;Inflation_t&space;&plus;&space;RealReturn_t&space;&\quad\text{for}\quad&space;t&space;\geq&space;0" title="ShortTermReturn_t= Inflation_t + RealReturn_t &\quad\text{for}\quad t \geq 0" /></a>

**Below is the SQL code used to run this query:**

		exec GenerateProjectedShortTermReturn @AssumptionSetNo
        
          Parameters 

          Assumption Set Number = @AssumptionSetNo        

#### 1.3.5. Long Term Return
<a href="https://www.codecogs.com/eqnedit.php?latex=LongTermReturn_t&space;=&space;ShortTermReturn_t&space;&plus;&space;TermPremium_t&space;&\quad\text{for}\quad&space;{t\geq0}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?LongTermReturn_t&space;=&space;ShortTermReturn_t&space;&plus;&space;TermPremium_t&space;&\quad\text{for}\quad&space;{t\geq0}" title="LongTermReturn_t = ShortTermReturn_t + TermPremium_t &\quad\text{for}\quad {t\geq0}" /></a>

**Below is the SQL code used to run this query:**

		exec GenerateProjectedLongTermReturn @AssumptionSetNo
        
          Parameters 

          Assumption Set Number = @AssumptionSetNo       

#### 1.3.6. Credit Spread
<a href="https://www.codecogs.com/eqnedit.php?latex=CreditSpread_t&space;=&space;CreditSpread_t_-_1&space;*&space;Weight&space;&plus;&space;CreditSpreadLongTerm_t&space;*&space;(1&space;-&space;Weight)&space;&plus;&space;Error&space;&\quad\text{for}\quad&space;{t\geq0}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?CreditSpread_t&space;=&space;CreditSpread_t_-_1&space;*&space;Weight&space;&plus;&space;CreditSpreadLongTerm_t&space;*&space;(1&space;-&space;Weight)&space;&plus;&space;Error&space;&\quad\text{for}\quad&space;{t\geq0}" title="CreditSpread_t = CreditSpread_t_-_1 * Weight + CreditSpreadLongTerm_t * (1 - Weight) + Error &\quad\text{for}\quad {t\geq0}" /></a>

**Below is the SQL code used to run this query:**

	  	exec GenerateProjectedCreditSpread @CS_tmin1, @w, @CS_LT, @sd_e, @mu_e, @AssumptionSetNo
        
          Parameters 

          Assumption Set Number = @AssumptionSetNo       

### 1.4. Generate Projected Asset Class Returns

All asset class returns are calculated at three levels, normal, stressed and combined, the probability of the economy entering a stressed scenario is set as a parameter before the process starts and should be the same for all asset classes within an assumption set.

#### 1.4.1. Fixed-Income Asset Classes
	   
Each of the seven fixed income asset classes, follow the same methodology described below:\
Under the normal regime:
<a href="https://www.codecogs.com/eqnedit.php?latex=\begin{array}{rcl}&space;NormalFixedIncome_t&space;&=&&space;{(ShortTermReturn&space;&plus;&space;e^{(ShortTermReturn_{(t-1)}-ShortTermReturn_t)*{\color{Red}ShortTermDuration}}-1)*{\color{Red}ShortTermWeight}}&space;\quad\text{for}\quad&space;{t\geq1},&space;\\&space;&&plus;&&space;{(LongTermReturn&space;&plus;&space;e^{(LongTermReturn_{(t-1)}-LongTermReturn_t)*{\color{Red}LongTermDuration}}-1)*{\color{Red}LongTermWeight}}&space;\\&space;&&plus;&&space;\epsilon\\&space;\end{array}&space;\\&space;\\&space;where\quad&space;\epsilon&space;=&space;\Phi^{-1}(RandomCreditPremium;{\color{Red}\alpha_{Manager}},&space;{\color{Red}\sigma})\quad&space;and&space;{\quad&space;RandomCreditPremium\sim&space;Uniform(0,1)}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\begin{array}{rcl}&space;NormalFixedIncome_t&space;&=&&space;{(ShortTermReturn&space;&plus;&space;e^{(ShortTermReturn_{(t-1)}-ShortTermReturn_t)*{\color{Red}ShortTermDuration}}-1)*{\color{Red}ShortTermWeight}}&space;\quad\text{for}\quad&space;{t\geq1},&space;\\&space;&&plus;&&space;{(LongTermReturn&space;&plus;&space;e^{(LongTermReturn_{(t-1)}-LongTermReturn_t)*{\color{Red}LongTermDuration}}-1)*{\color{Red}LongTermWeight}}&space;\\&space;&&plus;&&space;\epsilon\\&space;\end{array}&space;\\&space;\\&space;where\quad&space;\epsilon&space;=&space;\Phi^{-1}(RandomCreditPremium;{\color{Red}\alpha_{Manager}},&space;{\color{Red}\sigma})\quad&space;and&space;{\quad&space;RandomCreditPremium\sim&space;Uniform(0,1)}" title="\begin{array}{rcl} NormalFixedIncome_t &=& {(ShortTermReturn + e^{(ShortTermReturn_{(t-1)}-ShortTermReturn_t)*{\color{Red}ShortTermDuration}}-1)*{\color{Red}ShortTermWeight}} \quad\text{for}\quad {t\geq1}, \\ &+& {(LongTermReturn + e^{(LongTermReturn_{(t-1)}-LongTermReturn_t)*{\color{Red}LongTermDuration}}-1)*{\color{Red}LongTermWeight}} \\ &+& \epsilon\\ \end{array} \\ \\ where\quad \epsilon = \Phi^{-1}(RandomCreditPremium;{\color{Red}\alpha_{Manager}}, {\color{Red}\sigma})\quad and {\quad RandomCreditPremium\sim Uniform(0,1)}" /></a>

The stress regime is as follows
<a href="https://www.codecogs.com/eqnedit.php?latex=StressRegimeLoss_t=&space;{(1-CanadianEquityStressedRandomNumber_t)*{\color{Red}MaxLoss_{FixedIncome}}}\\" target="_blank"><img src="https://latex.codecogs.com/gif.latex?StressRegimeLoss_t=&space;{(1-CanadianEquityStressedRandomNumber_t)*{\color{Red}MaxLoss_{FixedIncome}}}\\" title="StressRegimeLoss_t= {(1-CanadianEquityStressedRandomNumber_t)*{\color{Red}MaxLoss_{FixedIncome}}}\\" /></a>

The combination of the normal and stress regimes is:
<a href="https://www.codecogs.com/eqnedit.php?latex=FixedIncome_t=&space;\begin{cases}&space;NormalFixedIncome_t&space;-&space;StressRegimeLoss_t&space;&\quad\text{for}\quad&space;RandomStressRegime&space;<&space;{\color{Red}StressRegimeProbability},\\&space;NormalFixedIncome_t&space;&\quad\text{for}\quad&space;RandomStressRegime&space;>&space;{\color{Red}StressRegimeProbability},\\&space;\end{cases}&space;\\&space;where&space;\quad&space;RandomStressRegime\sim&space;Uniform(0,1)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?FixedIncome_t=&space;\begin{cases}&space;NormalFixedIncome_t&space;-&space;StressRegimeLoss_t&space;&\quad\text{for}\quad&space;RandomStressRegime&space;<&space;{\color{Red}StressRegimeProbability},\\&space;NormalFixedIncome_t&space;&\quad\text{for}\quad&space;RandomStressRegime&space;>&space;{\color{Red}StressRegimeProbability},\\&space;\end{cases}&space;\\&space;where&space;\quad&space;RandomStressRegime\sim&space;Uniform(0,1)" title="FixedIncome_t= \begin{cases} NormalFixedIncome_t - StressRegimeLoss_t &\quad\text{for}\quad RandomStressRegime < {\color{Red}StressRegimeProbability},\\ NormalFixedIncome_t &\quad\text{for}\quad RandomStressRegime > {\color{Red}StressRegimeProbability},\\ \end{cases} \\ where \quad RandomStressRegime\sim Uniform(0,1)" /></a>

**Below is the SQL code used to run this query:**

		exec GenerateProjectedFIReturn @ST, @LT, @ST_Dur, @LT_Dur, @E_alpha, @sd_e, @max_loss, @prob_sr, @ReturnType, @AssumptionSetNo
        
           Parameters 
         
           Short Term weight = @ST,
           Long Term weight = @LT,
           Short Term duration = @ST_Dur,
           Long Term duration = @LT_Dur,
           Alpha of manager = @E_alpha,
           Standard deviation = @sd_e,
           Maximum Loss = @max_loss,
           Probability of entering Stress Regime = @prob_sr,
           Type of fixed income return = @ReturnType,
           Assumption Set Number = @AssumptionSetNo

Below are the seven fixed income assets classes, there is no need to enter all assets classes if your mix does not include each one.

1.4.1.1. Universal Bonds\
1.4.1.2. Long Term Bonds      
1.4.1.3. Corporate Debt      
1.4.1.4. Private Debt      
1.4.1.5. Short Term Credit      
1.4.1.6. Mortgages      
1.4.1.7. Borrowing Cost
		  
		  
#### 1.4.2. Non-Fixed Income Asset Classes (Abbreviation Used)
	   
Each of the eight non-fixed income asset classes, follow the same methodology described below:

* Canadian Equity (CdnEq)
* Global Equity (GloEq)
* Emerging Market Equity (EMEq) 
* Canadian Low-Volatility Equity (CdnLVEq)  
* Global Low-Volatility Equity (GloLVEq) 
* Private Equity (PE)  
* Infrastructure Equity (IE)
* Real Estate (RE)  

**Normal Regime**\
Under the normal regime, and using the result from **1.2.2.4.2.**:

<a href="https://www.codecogs.com/eqnedit.php?latex=NormalNonFixedIncomeReturn_t=&space;\Phi^{-1}(RandomNonFixedIncome_{t};{\color{Red}\mu_{RiskPremium}},&space;{\color{Red}\sigma_{Risk&space;Premium}})&space;\\&space;\\" target="_blank"><img src="https://latex.codecogs.com/gif.latex?NormalNonFixedIncomeReturn_t=&space;\Phi^{-1}(RandomNonFixedIncome_{t};{\color{Red}\mu_{RiskPremium}},&space;{\color{Red}\sigma_{Risk&space;Premium}})&space;\\&space;\\" title="NormalNonFixedIncomeReturn_t= \Phi^{-1}(RandomNonFixedIncome_{t};{\color{Red}\mu_{RiskPremium}}, {\color{Red}\sigma_{Risk Premium}}) \\ \\" /></a>

**Stressed Regime**\
Under the stressed regime from the result in **1.2.3.**, we use:

<a href="https://www.codecogs.com/eqnedit.php?latex=ReturnUnderStressedRegime_t" target="_blank"><img src="https://latex.codecogs.com/gif.latex?ReturnUnderStressedRegime_t" title="ReturnUnderStressedRegime_t" /></a>

**Combined Regimes**\
Using the same random stressed regime numbers from 1.4.1.1, the combination of the normal and stressed regime is:

<a href="https://www.codecogs.com/eqnedit.php?latex=NonFixed&space;IncomeReturn=\begin{cases}&space;ReturnUnderStressedRegime_t&space;&\quad\text{for}\quad&space;RandomStressRegime&space;<&space;{\color{Red}StressRegimeProbability},\\&space;NormalNon-FixedIncomeReturn_t&space;&\quad\text{for}\quad&space;RandomStressRegime&space;>&space;{\color{Red}StressRegimeProbability},\\&space;\end{cases}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?NonFixed&space;IncomeReturn=\begin{cases}&space;ReturnUnderStressedRegime_t&space;&\quad\text{for}\quad&space;RandomStressRegime&space;<&space;{\color{Red}StressRegimeProbability},\\&space;NormalNon-FixedIncomeReturn_t&space;&\quad\text{for}\quad&space;RandomStressRegime&space;>&space;{\color{Red}StressRegimeProbability},\\&space;\end{cases}" title="NonFixed IncomeReturn=\begin{cases} ReturnUnderStressedRegime_t &\quad\text{for}\quad RandomStressRegime < {\color{Red}StressRegimeProbability},\\ NormalNon-FixedIncomeReturn_t &\quad\text{for}\quad RandomStressRegime > {\color{Red}StressRegimeProbability},\\ \end{cases}" /></a>

**Below is the SQL code used to run this query:**

		exec GenerateProjectedNFIReturn @ST_Weight, @LT_Weight, @mu_rp, @sd_rp, @prob_sr, @ReturnType, @AssumptionSetNo
        
        	Parameters
            
            Short Term weight = @ST_weight,
            Long Term weight = @LT_weight,
            Expected Risk Premium = @mu_rp
            Standard Deviation of Risk Premium = @sd_rp
            Probability of entering Stress Regime = @prob_sr,
            Type of non-fixed income return = @ReturnType,
            Assumption Set Number = @AssumptionSetNo

Below are the eight non-fixed income assets classes, there is no need to enter all assets classes if your mix does not include each one.

1.4.2.1. Canadian Equity (CdnEq)\
1.4.2.2. Global Equity (GloEq)      
1.4.2.3. Emerging Market Equity (EMEq)      
1.4.2.4. Canadian Low-Volatility Equity (CdnLVEq)      
1.4.2.5. Global Low-Volatility Equity (GloLVEq)      
1.4.2.6. Private Equity (PE)      
1.4.2.7. Infrastructure Equity (IE)      
1.4.2.8. Real Estate (RE)
		  
### 2. Result Set


The second step in running the ALM is to set up the "Result Set". This term is used to describe the model results given for each of the asset and liability sections. It also contains some additional assumptions that are derived after the definition of the asset mix. Each "Result Set" is associated with a single asset mix as defined by the user.

#### 2.1. Load Result Set into Database (Create_Result_Set)

Details on each "Result Set" is stored in the database in the dbo.ResultSet table, it contains the following fields that need to be populated before physically creating the asset mix and discount rate associated with the result set.

		*ResultSetKey* - assigned by the database as unique identifier     
		*ResultSetNo* - assigned by the user   
		*AssumptionSetNo* - assigned by the user, should link to existing assumption set   
		*MixName* - assigned by the user, should be the same as the name used when defining the asset mix   
		*ResultSetDescript* - assigned by the user   
		*CreatedDate* - assigned by the database   
		*CreatedBy* - assigned by the database, linked to the user login used     
	
Running in SQL
								
        <exec [dbo].[Create_ResultSet] '[{ @ResultSetNo}]',>
	
Running from Excel 

Choose (x) from dropdown
update parameter values
<Screenshot?>
		
#### 2.2. Define the Asset Mix and Result Set
First define the asset mix you wish to use.

		exec GenerateProjectedPortfolioReturn @UBond_Weight, @LTBond_Weight, @Mort_Weight, @Corp_Weight, @PrDebt_Weight, @STCr_Weight, @BorrowCst_Weight, @CdnEq_Weight, @GloEq_Weight, @EMEq_Weight, @CdnLVEq_Weight, @GloLVEq_Weight, @PE_Weight, @IE_Weight, @RE_Weight, @MixName, @AssumptionSetNo
        
        Parameters 
        Universe Bonds Allocation = @UBond_Weight,
        Long Term Bonds Allocation = @LTBond_Weight,
        Mortgage Allocation = @Mort_Weight,
        Corporates Allocation = @Corp_Weight,
        Private Debt Allocation = @PrDebt_Weight,
        Short Term Credit Allocation = @STCr_Weight,
        Borrowing Cost Allocation = @BorrowCst_Weight,
        Canadian Equity Allocation = @CdnEq_Weight,
        Global Equity Allocation = @GloEq_Weight,
        Emerging Markets Equity Allocation = @EmEq_Weight,
        Canadian Low-Volatility Equity Allocation = @CdnLVEq_Weight,
        Global Low-Volatility Equity Allocation = @GloLVEq_Weight,
        Private Equity Allocation = @PE_Weight,
        Infrastructure Equity Allocation = @IE_Weight,
        Real Estate Equity Allocation = @RE_Weight,
        User's given name of the asset mix = @MixName
        Assumption Set Number = @AssumptionSetNo
        
 Next assign your asset mix to a result set.
 
        exec Create_ResultSet @AssumptionSetNo, @MixName, @ResultSetDescript
      
        
#### 2.3. Generate additional ALM assumptions
##### 2.3.1. Define the Discount Rate
Both going concern and solvency discount rates are projected in the same manner, hence the follow equation applies to both:
<a href="https://www.codecogs.com/eqnedit.php?latex=DiscountRate_t=&space;\begin{cases}&space;{\color{Red}DiscountRate_{0}}&space;&\quad\text{for}\quad&space;t&space;=&space;0,\\&space;\begin{array}{rcl}&space;&=&&space;DiscountRate_{t-1}&space;\\&space;&&plus;&&space;(ShortTermReturn_t-ShortTermReturn_{t-1})*{{\color{Red}ShortTermWeight}}&space;\\&space;&&plus;&&space;(LongTermReturn_t&space;-LongTermReturn_{t-1})*{{\color{Red}LongTermWeight}}*{{\color{Red}ProportionOfYieldToBeReflected}}\\&space;\end{array}&space;&\quad\text{for}\quad&space;t&space;>&space;0,\\&space;\end{cases}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?DiscountRate_t=&space;\begin{cases}&space;{\color{Red}DiscountRate_{0}}&space;&\quad\text{for}\quad&space;t&space;=&space;0,\\&space;\begin{array}{rcl}&space;&=&&space;DiscountRate_{t-1}&space;\\&space;&&plus;&&space;(ShortTermReturn_t-ShortTermReturn_{t-1})*{{\color{Red}ShortTermWeight}}&space;\\&space;&&plus;&&space;(LongTermReturn_t&space;-LongTermReturn_{t-1})*{{\color{Red}LongTermWeight}}*{{\color{Red}ProportionOfYieldToBeReflected}}\\&space;\end{array}&space;&\quad\text{for}\quad&space;t&space;>&space;0,\\&space;\end{cases}" title="DiscountRate_t= \begin{cases} {\color{Red}DiscountRate_{0}} &\quad\text{for}\quad t = 0,\\ \begin{array}{rcl} &=& DiscountRate_{t-1} \\ &+& (ShortTermReturn_t-ShortTermReturn_{t-1})*{{\color{Red}ShortTermWeight}} \\ &+& (LongTermReturn_t -LongTermReturn_{t-1})*{{\color{Red}LongTermWeight}}*{{\color{Red}ProportionOfYieldToBeReflected}}\\ \end{array} &\quad\text{for}\quad t > 0,\\ \end{cases}" /></a>
**Below is the SQL code used to run this query:**

		exec GenerateProjectedDiscountRate @DIS_initial, @ST, @LT, @PercentReflected, @InterestRateType, @ResultSetNo
        
          Parameters 
          
          Time 0 Discount Rate = @DIS_initial,
          Weight (Proportion of Short-Term Inflation reflected) = @ST,
          Weight (Proportion of Long-Term Inflation reflected) = @LT,
          Proportion of yield change to be reflected in discount rate = @PercentReflected,
          Type of discount rate (GC, or SOLV) = @InterestRateType,
          Result Set Number assigned to specified asset mix = @ResultSetNo
2.3.1.1. Going Concern Basis\
2.3.1.2. Solvency Basis
##### 2.3.2. Salary Increases
Run in GenerateProjectedLongTermReturn query, salary increases are computed using the following equation:

<a href="https://www.codecogs.com/eqnedit.php?latex=SalaryIncrease_t&space;=&space;max(Inflation_t,0)" target="_blank"><img src="https://latex.codecogs.com/gif.latex?SalaryIncrease_t&space;=&space;max(Inflation_t,0)" title="SalaryIncrease_t = max(Inflation_t,0)" /></a>
##### 2.3.3. Normal Cost/Future Service Change
The annual change to normal cost and future service is computed using the following formula:

<a href="https://www.codecogs.com/eqnedit.php?latex=NCFC\Delta&space;=&space;(1&plus;SalaryIncrease_t)(1-{\color{Red}ActiveAnnualDecline})&space;-&space;1\quad\text{for}\quad&space;{t&space;>&space;0}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?NCFC\Delta&space;=&space;(1&plus;SalaryIncrease_t)(1-{\color{Red}ActiveAnnualDecline})&space;-&space;1\quad\text{for}\quad&space;{t&space;>&space;0}" title="NCFC\Delta = (1+SalaryIncrease_t)(1-{\color{Red}ActiveAnnualDecline}) - 1\quad\text{for}\quad {t > 0}" /></a>

**Below is the SQL code used to run this query:**

		exec GenerateProjectedNCFSChange @ActiveDecline @AssumptionSetNo
        
          Parameters 
          
          Annual decline(+%)/Annual increase(-%) in active population = @ActiveDecline,
     	  Assumption Set Number = @AssumptionSetNo
##### 2.3.4. COLAs (Cost of Living Adjustments) *TO DO*
##### 2.3.5. Benefit Reductions/Enhancements *TO DO*

#### 2.4. Upload the Liability Cash Flows
The liability cash flows is either sourced internally from Proval or externally from third party valuation, the dataloader can be used to upload the liability cash flows.

#### 2.5. Project Liability (SEPP/MEPP)
From the three results below, the going concern liability is computed as follows:
<a href="https://www.codecogs.com/eqnedit.php?latex=GoingConcernLiability_t&space;=&space;{[PV(AccruedLiability_t)&plus;PV(NormalCost_t)&plus;PV(FSCost_t)]*(1&plus;GCDiscount_t)^{6/12}}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?GoingConcernLiability_t&space;=&space;{[PV(AccruedLiability_t)&plus;PV(NormalCost_t)&plus;PV(FSCost_t)]*(1&plus;GCDiscount_t)^{6/12}}" title="GoingConcernLiability_t = {[PV(AccruedLiability_t)+PV(NormalCost_t)+PV(FSCost_t)]*(1+GCDiscount_t)^{6/12}}" /></a>
Similarly, the solvency liability is calculated as follows:
<a href="https://www.codecogs.com/eqnedit.php?latex=SolvencyLiability_t&space;=&space;{[PV(AccruedLiability_t)&plus;PV(NormalCost_t)]*(1&plus;SolvDiscount_t)^{6/12}}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?SolvencyLiability_t&space;=&space;{[PV(AccruedLiability_t)&plus;PV(NormalCost_t)]*(1&plus;SolvDiscount_t)^{6/12}}" title="SolvencyLiability_t = {[PV(AccruedLiability_t)+PV(NormalCost_t)]*(1+SolvDiscount_t)^{6/12}}" /></a>
##### 2.5.1. Accrued Liability
<a href="https://www.codecogs.com/eqnedit.php?latex=PV(AccruedLiability_t)&space;=&space;\sum_{i=0}^{\infty}\frac{AccruedLiabilityCF_i}{(1&plus;Discount_t)^i}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?PV(AccruedLiability_t)&space;=&space;\sum_{i=0}^{\infty}\frac{AccruedLiabilityCF_i}{(1&plus;Discount_t)^i}" title="PV(AccruedLiability_t) = \sum_{i=0}^{\infty}\frac{AccruedLiabilityCF_i}{(1+Discount_t)^i}" /></a>
\
Where the discount rate corresponds to the type of liability that is calculated.
##### 2.5.2. Normal Costs
<a href="https://www.codecogs.com/eqnedit.php?latex=PV(NormalCost_t)&space;=&space;{\sum_{i=1}^{100&space;}\sum_{j=i}^{i&plus;t-1}NormalCostCF_j&space;*&space;\prod_{k=1}^{i&plus;t-1-j}(1&plus;NCFV\Delta_k)*(1&plus;Discount_t)^{i}}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?PV(NormalCost_t)&space;=&space;{\sum_{i=1}^{100&space;}\sum_{j=i}^{i&plus;t-1}NormalCostCF_j&space;*&space;\prod_{k=1}^{i&plus;t-1-j}(1&plus;NCFV\Delta_k)*(1&plus;Discount_t)^{i}}" title="PV(NormalCost_t) = {\sum_{i=1}^{100 }\sum_{j=i}^{i+t-1}NormalCostCF_j * \prod_{k=1}^{i+t-1-j}(1+NCFV\Delta_k)*(1+Discount_t)^{i}}" /></a>
Where the discount rate corresponds to the type of liability that is calculated.
##### 2.5.3. Future Service Costs
<a href="https://www.codecogs.com/eqnedit.php?latex=PV(FSCost_t)&space;=&space;{\sum_{i=1}^{100}FSCF_i*\prod_{j=1}^{t}(1&plus;Return_j)(1&plus;GCDiscount_t)^{i}}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?PV(FSCost_t)&space;=&space;{\sum_{i=1}^{100}FSCF_i*\prod_{j=1}^{t}(1&plus;Return_j)(1&plus;GCDiscount_t)^{i}}" title="PV(FSCost_t) = {\sum_{i=1}^{100}FSCF_i*\prod_{j=1}^{t}(1+Return_j)(1+GCDiscount_t)^{i}}" /></a>
#### 2.6. Project Asset Values (MEPP)
##### 2.6.1. Benefit Payments
<a href="https://www.codecogs.com/eqnedit.php?latex=BP_t=&space;\begin{cases}&space;AccruedLiabilityCF_1&space;&\quad\text{for}\quad&space;t=1,\\&space;AccruedLiabilityCF_2&space;&plus;NormalCostCF_1&space;&\quad\text{for}\quad&space;t=2,&space;\\&space;AccruedLiabilityCF_t&space;&plus;\sum_{j=1}^{t-1}NormalCostCF_j&space;*&space;\prod_{k=1}^{t-j}(1&plus;NCFV\Delta_k)&\quad\text{for}\quad&space;t&space;\ge&space;3&space;\end{cases}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?BP_t=&space;\begin{cases}&space;AccruedLiabilityCF_1&space;&\quad\text{for}\quad&space;t=1,\\&space;AccruedLiabilityCF_2&space;&plus;NormalCostCF_1&space;&\quad\text{for}\quad&space;t=2,&space;\\&space;AccruedLiabilityCF_t&space;&plus;\sum_{j=1}^{t-1}NormalCostCF_j&space;*&space;\prod_{k=1}^{t-j}(1&plus;NCFV\Delta_k)&\quad\text{for}\quad&space;t&space;\ge&space;3&space;\end{cases}" title="BP_t= \begin{cases} AccruedLiabilityCF_1 &\quad\text{for}\quad t=1,\\ AccruedLiabilityCF_2 +NormalCostCF_1 &\quad\text{for}\quad t=2, \\ AccruedLiabilityCF_t +\sum_{j=1}^{t-1}NormalCostCF_j * \prod_{k=1}^{t-j}(1+NCFV\Delta_k)&\quad\text{for}\quad t \ge 3 \end{cases}" /></a>
##### 2.6.2. Contributions
<a href="https://www.codecogs.com/eqnedit.php?latex=Contribution_t&space;=&space;\begin{cases}&space;Contribution_0&space;&\quad\text{for}\quad&space;{t=0},\\&space;Contribution_0&space;*&space;\prod_{1}^{t}&space;(1&plus;NCFS\Delta_t)&\quad\text{for}\quad&space;{t\ge&space;1}\end{cases}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?Contribution_t&space;=&space;\begin{cases}&space;Contribution_0&space;&\quad\text{for}\quad&space;{t=0},\\&space;Contribution_0&space;*&space;\prod_{1}^{t}&space;(1&plus;NCFS\Delta_t)&\quad\text{for}\quad&space;{t\ge&space;1}\end{cases}" title="Contribution_t = \begin{cases} Contribution_0 &\quad\text{for}\quad {t=0},\\ Contribution_0 * \prod_{1}^{t} (1+NCFS\Delta_t)&\quad\text{for}\quad {t\ge 1}\end{cases}" /></a>
##### 2.6.3. Cash Flows
<a href="https://www.codecogs.com/eqnedit.php?latex=CF_t&space;=&space;Contribution_t&space;-&space;BP_t&space;-&space;{\color{Red}AdminInvestmentFee}*MVA_{t-1}&space;\quad\text{for}\quad&space;{t\ge&space;1}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?CF_t&space;=&space;Contribution_t&space;-&space;BP_t&space;-&space;{\color{Red}AdminInvestmentFee}*MVA_{t-1}&space;\quad\text{for}\quad&space;{t\ge&space;1}" title="CF_t = Contribution_t - BP_t - {\color{Red}AdminInvestmentFee}*MVA_{t-1} \quad\text{for}\quad {t\ge 1}" /></a>
##### 2.6.4. Market Value of Assets (MVA)
<a href="https://www.codecogs.com/eqnedit.php?latex=MVA_t=&space;\begin{cases}&space;{\color{Red}MVA_0}&space;&\quad\text{for}\quad&space;t=0,\\&space;MVA_{t-1}&plus;CF_t*(1&plus;Return_t)^{6/12}&\quad\text{for}\quad&space;t&space;\geq&space;1,\\&space;\end{cases}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?MVA_t=&space;\begin{cases}&space;{\color{Red}MVA_0}&space;&\quad\text{for}\quad&space;t=0,\\&space;MVA_{t-1}&plus;CF_t*(1&plus;Return_t)^{6/12}&\quad\text{for}\quad&space;t&space;\geq&space;1,\\&space;\end{cases}" title="MVA_t= \begin{cases} {\color{Red}MVA_0} &\quad\text{for}\quad t=0,\\ MVA_{t-1}+CF_t*(1+Return_t)^{6/12}&\quad\text{for}\quad t \geq 1,\\ \end{cases}" /></a>
#### 2.6. Project Asset Values (SEPP)
##### 2.6.1. Benefit Payments
<a href="https://www.codecogs.com/eqnedit.php?latex=BP_t=&space;\begin{cases}&space;AccruedLiabilityCF_1&space;&\quad\text{for}\quad&space;t=1,\\&space;AccruedLiabilityCF_2&space;&plus;NormalCostCF_1&space;&\quad\text{for}\quad&space;t=2,&space;\\&space;AccruedLiabilityCF_t&space;&plus;\sum_{j=1}^{t-1}NormalCostCF_j&space;*&space;\prod_{k=1}^{t-j}(1&plus;NCFV\Delta_k)&\quad\text{for}\quad&space;t&space;\ge&space;3&space;\end{cases}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?BP_t=&space;\begin{cases}&space;AccruedLiabilityCF_1&space;&\quad\text{for}\quad&space;t=1,\\&space;AccruedLiabilityCF_2&space;&plus;NormalCostCF_1&space;&\quad\text{for}\quad&space;t=2,&space;\\&space;AccruedLiabilityCF_t&space;&plus;\sum_{j=1}^{t-1}NormalCostCF_j&space;*&space;\prod_{k=1}^{t-j}(1&plus;NCFV\Delta_k)&\quad\text{for}\quad&space;t&space;\ge&space;3&space;\end{cases}" title="BP_t= \begin{cases} AccruedLiabilityCF_1 &\quad\text{for}\quad t=1,\\ AccruedLiabilityCF_2 +NormalCostCF_1 &\quad\text{for}\quad t=2, \\ AccruedLiabilityCF_t +\sum_{j=1}^{t-1}NormalCostCF_j * \prod_{k=1}^{t-j}(1+NCFV\Delta_k)&\quad\text{for}\quad t \ge 3 \end{cases}" /></a>
##### 2.6.2. Normal Cost Payments
<a href="https://www.codecogs.com/eqnedit.php?latex=NCPayment_t&space;=&space;\begin{cases}&space;\sum_{i=1}^{100}\frac{NormalCostCF_i}{1&plus;GCDiscount_0}*(1&plus;GCDiscount_0)^{6/12}*(1&plus;PfAD)&space;&\quad\text{for}\quad&space;{t=&space;1},\\&space;\sum_{i=1}^{100}\frac{NormalCostCF_i}{1&plus;GCDiscount_{t-1}}*(1&plus;GCDiscount_{t-1})^{6/12}*\prod_{j=1}^{t-1}(1&plus;NCFS\Delta_j)(1&plus;PfAD)&\quad\text{for}\quad&space;{t\ge&space;2}\end{cases}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?NCPayment_t&space;=&space;\begin{cases}&space;\sum_{i=1}^{100}\frac{NormalCostCF_i}{1&plus;GCDiscount_0}*(1&plus;GCDiscount_0)^{6/12}*(1&plus;PfAD)&space;&\quad\text{for}\quad&space;{t=&space;1},\\&space;\sum_{i=1}^{100}\frac{NormalCostCF_i}{1&plus;GCDiscount_{t-1}}*(1&plus;GCDiscount_{t-1})^{6/12}*\prod_{j=1}^{t-1}(1&plus;NCFS\Delta_j)(1&plus;PfAD)&\quad\text{for}\quad&space;{t\ge&space;2}\end{cases}" title="NCPayment_t = \begin{cases} \sum_{i=1}^{100}\frac{NormalCostCF_i}{1+GCDiscount_0}*(1+GCDiscount_0)^{6/12}*(1+PfAD) &\quad\text{for}\quad {t= 1},\\ \sum_{i=1}^{100}\frac{NormalCostCF_i}{1+GCDiscount_{t-1}}*(1+GCDiscount_{t-1})^{6/12}*\prod_{j=1}^{t-1}(1+NCFS\Delta_j)(1+PfAD)&\quad\text{for}\quad {t\ge 2}\end{cases}" /></a>
##### 2.6.3. Funded Status
<a href="https://www.codecogs.com/eqnedit.php?latex=FundedStatus_t&space;=&space;\begin{cases}&space;MVA_0&space;-&space;SolvencyLiabiity_0&space;-&space;{\color{Red}WindUpExpense}&\quad\text{for}\quad&space;{t=&space;2},&space;\\MVA_{t-2}&space;-&space;SolvencyLiabiity_{t-2}&space;-&space;{\color{Red}WindUpExpense}*\prod_{i=1}^{t}(1&plus;Inflation_i)&\quad\text{for}\quad&space;{t\ge&space;3},\end{cases}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?FundedStatus_t&space;=&space;\begin{cases}&space;MVA_0&space;-&space;SolvencyLiabiity_0&space;-&space;{\color{Red}WindUpExpense}&\quad\text{for}\quad&space;{t=&space;2},&space;\\MVA_{t-2}&space;-&space;SolvencyLiabiity_{t-2}&space;-&space;{\color{Red}WindUpExpense}*\prod_{i=1}^{t}(1&plus;Inflation_i)&\quad\text{for}\quad&space;{t\ge&space;3},\end{cases}" title="FundedStatus_t = \begin{cases} MVA_0 - SolvencyLiabiity_0 - {\color{Red}WindUpExpense}&\quad\text{for}\quad {t= 2}, \\MVA_{t-2} - SolvencyLiabiity_{t-2} - {\color{Red}WindUpExpense}*\prod_{i=1}^{t}(1+Inflation_i)&\quad\text{for}\quad {t\ge 3},\end{cases}" /></a>
##### 2.6.4. Deficiency Payment
<a href="https://www.codecogs.com/eqnedit.php?latex=DeficiencyPayment_t&space;=&space;\begin{cases}&space;0&space;&\quad\text{for}\quad&space;{t=0,1},\\&space;0&\quad\text{for}\quad{t=&space;2}\quad&space;and&space;\quad&space;FundedStatus_2>0,&space;\\&space;\frac{-FundedStatus_2}{(1&plus;SolvDiscount_0)^{6/12}}/\frac{1&plus;\frac{1}{(1&plus;SolvDiscount_0)^5}}{SolvDiscount_0}&space;&\quad\text{for}\quad{t=&space;2}\quad&space;and&space;\quad&space;FundedStatus_2<0,&space;\\&space;0&\quad\text{for}\quad&space;{t\ge&space;3}\quad&space;and&space;\quad&space;FundedStatus_2>0,\\&space;DeficiencyPayment_{t-1}&\quad\text{for}\quad&space;{t\ge&space;3}\quad&space;and&space;\quad&space;DeficiencyPayment_t'<DeficiencyPayment_{t-1}\\&space;\frac{(SolvencyLiability_{t-2}&space;-&space;MVA_{t-2})}{(1&plus;SolvDiscount_{t-2})^{6/12}}/\frac{1&plus;\frac{1}{(1&plus;SolvDiscount_{t-2})^5}}{SolvDiscount_{t-2}}=DeficiencyPayment_t'&space;&\quad\text{for}\quad&space;{t\ge&space;3}\quad&space;and&space;\quad&space;DeficiencyPayment_t'>DeficiencyPayment_{t-1}\\&space;\end{cases}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?DeficiencyPayment_t&space;=&space;\begin{cases}&space;0&space;&\quad\text{for}\quad&space;{t=0,1},\\&space;0&\quad\text{for}\quad{t=&space;2}\quad&space;and&space;\quad&space;FundedStatus_2>0,&space;\\&space;\frac{-FundedStatus_2}{(1&plus;SolvDiscount_0)^{6/12}}/\frac{1&plus;\frac{1}{(1&plus;SolvDiscount_0)^5}}{SolvDiscount_0}&space;&\quad\text{for}\quad{t=&space;2}\quad&space;and&space;\quad&space;FundedStatus_2<0,&space;\\&space;0&\quad\text{for}\quad&space;{t\ge&space;3}\quad&space;and&space;\quad&space;FundedStatus_2>0,\\&space;DeficiencyPayment_{t-1}&\quad\text{for}\quad&space;{t\ge&space;3}\quad&space;and&space;\quad&space;DeficiencyPayment_t'<DeficiencyPayment_{t-1}\\&space;\frac{(SolvencyLiability_{t-2}&space;-&space;MVA_{t-2})}{(1&plus;SolvDiscount_{t-2})^{6/12}}/\frac{1&plus;\frac{1}{(1&plus;SolvDiscount_{t-2})^5}}{SolvDiscount_{t-2}}=DeficiencyPayment_t'&space;&\quad\text{for}\quad&space;{t\ge&space;3}\quad&space;and&space;\quad&space;DeficiencyPayment_t'>DeficiencyPayment_{t-1}\\&space;\end{cases}" title="DeficiencyPayment_t = \begin{cases} 0 &\quad\text{for}\quad {t=0,1},\\ 0&\quad\text{for}\quad{t= 2}\quad and \quad FundedStatus_2>0, \\ \frac{-FundedStatus_2}{(1+SolvDiscount_0)^{6/12}}/\frac{1+\frac{1}{(1+SolvDiscount_0)^5}}{SolvDiscount_0} &\quad\text{for}\quad{t= 2}\quad and \quad FundedStatus_2<0, \\ 0&\quad\text{for}\quad {t\ge 3}\quad and \quad FundedStatus_2>0,\\ DeficiencyPayment_{t-1}&\quad\text{for}\quad {t\ge 3}\quad and \quad DeficiencyPayment_t'<DeficiencyPayment_{t-1}\\ \frac{(SolvencyLiability_{t-2} - MVA_{t-2})}{(1+SolvDiscount_{t-2})^{6/12}}/\frac{1+\frac{1}{(1+SolvDiscount_{t-2})^5}}{SolvDiscount_{t-2}}=DeficiencyPayment_t' &\quad\text{for}\quad {t\ge 3}\quad and \quad DeficiencyPayment_t'>DeficiencyPayment_{t-1}\\ \end{cases}" /></a>
##### 2.6.5. Contributions
<a href="https://www.codecogs.com/eqnedit.php?latex=Contribution_t&space;=&space;\begin{cases}&space;0&space;&\quad\text{for}\quad&space;{t=0},\\&space;NCPayment_t&space;&plus;&space;DeficiencyPayment_t&\quad\text{for}\quad&space;{t\ge&space;1}\end{cases}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?Contribution_t&space;=&space;\begin{cases}&space;0&space;&\quad\text{for}\quad&space;{t=0},\\&space;NCPayment_t&space;&plus;&space;DeficiencyPayment_t&\quad\text{for}\quad&space;{t\ge&space;1}\end{cases}" title="Contribution_t = \begin{cases} 0 &\quad\text{for}\quad {t=0},\\ NCPayment_t + DeficiencyPayment_t&\quad\text{for}\quad {t\ge 1}\end{cases}" /></a>
##### 2.6.6. Cash Flows
<a href="https://www.codecogs.com/eqnedit.php?latex=CF_t&space;=&space;Contribution_t&space;-&space;BP_t&space;-&space;{\color{Red}AdminInvestmentFee}*MVA_{t-1}&space;\quad\text{for}\quad&space;{t\ge&space;1}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?CF_t&space;=&space;Contribution_t&space;-&space;BP_t&space;-&space;{\color{Red}AdminInvestmentFee}*MVA_{t-1}&space;\quad\text{for}\quad&space;{t\ge&space;1}" title="CF_t = Contribution_t - BP_t - {\color{Red}AdminInvestmentFee}*MVA_{t-1} \quad\text{for}\quad {t\ge 1}" /></a>
##### 2.6.7. Market Value of Assets (MVA)
<a href="https://www.codecogs.com/eqnedit.php?latex=MVA_t=&space;\begin{cases}&space;{\color{Red}MVA_0}&space;&\quad\text{for}\quad&space;t=0,\\&space;MVA_{t-1}&plus;CF_t*(1&plus;Return_t)^{6/12}&\quad\text{for}\quad&space;t&space;\geq&space;1,\\&space;\end{cases}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?MVA_t=&space;\begin{cases}&space;{\color{Red}MVA_0}&space;&\quad\text{for}\quad&space;t=0,\\&space;MVA_{t-1}&plus;CF_t*(1&plus;Return_t)^{6/12}&\quad\text{for}\quad&space;t&space;\geq&space;1,\\&space;\end{cases}" title="MVA_t= \begin{cases} {\color{Red}MVA_0} &\quad\text{for}\quad t=0,\\ MVA_{t-1}+CF_t*(1+Return_t)^{6/12}&\quad\text{for}\quad t \geq 1,\\ \end{cases}" /></a>
#### 2.7. Generate ALM output
	
# Configuration

# Frequently asked questions

# Don'ts

# Deployment



